<?xml version="1.0"?>

<launch>
  <!-- start Gazebo with an factory world and kobuki, mars robot -->

  <include file="$(find kobuki_stereo_launch)/launch/kobuki_empty_world.launch" />
  
  <node name="joy" pkg="joy" type="joy_node">
    <param name="dev" value="/dev/input/js0"/>
    <param name="autorepeat_rate" value="10.0"/>
  </node>
  
  <node pkg="kobuki_keyop" type="keyop" name="keyop" output="screen">
    <remap from="keyop/motor_power" to="mobile_base/commands/motor_power"/>
    <remap from="keyop/cmd_vel" to="mobile_base/commands/velocity"/>
    <param name="linear_vel_step"  value="0.4" type="double"/>
    <param name="linear_vel_max"   value="0.3"  type="double"/>
    <param name="angular_vel_step" value="0.3" type="double"/>
    <param name="angular_vel_max"  value="0.2"  type="double"/>
    <param name="wait_for_connection_" value="true" type="bool"/>
  </node>

  <!--
  <group ns="warehouse">
    <include file="$(find kobuki_description_mesh_changed)/launch/includes/warehouse.launch.xml" pass_all_args="true">
      <arg name="position_y" value="6"/>
      <arg name="position_x" value="10"/>
      <arg name="yaw" default="1.57"/>
    </include>
    
    <node name="joy" pkg="joy" type="joy_node">
      <param name="dev" value="/dev/input/js0"/>
      <param name="autorepeat_rate" value="10.0"/>
    </node>
    
    <node name="teleop_twist_joy" pkg="teleop_twist_joy" type="teleop_node">
      <remap from="cmd_vel" to="mobile_base/commands/velocity"/>
      <param name="scale_linear" value="0.7"/>
      <param name="scale_angular" value="0.3"/> 
    </node>
  </group>
  -->
  
  <group ns="mars">
    <include file="$(find kobuki_description_mesh_changed)/launch/includes/mars.launch.xml" pass_all_args="true">
      <arg name="position_y" value="5"/>
      <arg name="position_x" value="4"/>
    </include>
    
    <node name="joy" pkg="joy" type="joy_node">
      <param name="dev" value="/dev/input/js0"/>
      <param name="autorepeat_rate" value="10.0"/>
    </node>
    
    <node name="teleop_twist_joy" pkg="teleop_twist_joy" type="teleop_node">
      <remap from="cmd_vel" to="mobile_base/commands/velocity"/>
      <param name="scale_linear" value="0.7"/>
      <param name="scale_angular" value="0.0"/>
    </node>
  </group>
</launch>
